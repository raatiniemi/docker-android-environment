#!/usr/bin/env bash
render_template () {
  echo '########################';
  echo '# Do not edit this file, it is generated from Dockerfile.template';
  echo '# using the `bin/generate-from-template` script.';
  echo '########################';
  sed -e "s/ %%ANDROID_API%%/${1}/g" "Dockerfile.template";
}

render_template > "jdk8/Dockerfile";

VERSIONS=("28" "29" "30")
for VERSION in ${VERSIONS[*]}; do
  if [ ! -d "jdk8/${VERSION}" ]; then
    echo "Create directory for version: ${VERSION}";
    mkdir "jdk8/${VERSION}";
  fi;

  INSTALL_ANDROID_API="yes | sdkmanager \"platforms;android-${VERSION}\"";
  render_template " \&\& ${INSTALL_ANDROID_API}" > "jdk8/${VERSION}/Dockerfile";
done;
