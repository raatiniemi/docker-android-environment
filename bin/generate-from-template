#!/usr/bin/env bash
render_template () {
  echo '########################';
  echo '# Do not edit this file, it is generated from Dockerfile.template';
  echo '# using the `bin/generate-from-template` script.';
  echo '########################';
  sed -e "s/ %%ANDROID_API%%/${1}/g" "Dockerfile.template";
}

render_template > "jdk8/Dockerfile";

for API_VERSION in "28" "29" "30"; do
  if [ ! -d "jdk8/${API_VERSION}" ]; then
    echo "Create directory for version: ${API_VERSION}";
    mkdir "jdk8/${API_VERSION}";
  fi;

  INSTALL_ANDROID_API="yes | sdkmanager \"platforms;android-${API_VERSION}\"";
  render_template " \&\& ${INSTALL_ANDROID_API}" > "jdk8/${API_VERSION}/Dockerfile";
done;
